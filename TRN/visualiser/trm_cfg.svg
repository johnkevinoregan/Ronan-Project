<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: TRM_Flow Pages: 1 -->
<svg width="854pt" height="675pt"
 viewBox="0.00 0.00 854.00 675.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 671)">
<title>TRM_Flow</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-671 850,-671 850,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_1</title>
<path fill="none" stroke="#d3d3d3" d="M20,-8C20,-8 370,-8 370,-8 376,-8 382,-14 382,-20 382,-20 382,-647 382,-647 382,-653 376,-659 370,-659 370,-659 20,-659 20,-659 14,-659 8,-653 8,-647 8,-647 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="195" y="-643.8" font-family="Times,serif" font-size="14.00" fill="#000000">forward_inner</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_2</title>
<path fill="none" stroke="#d3d3d3" d="M402,-152C402,-152 826,-152 826,-152 832,-152 838,-158 838,-164 838,-164 838,-647 838,-647 838,-653 832,-659 826,-659 826,-659 402,-659 402,-659 396,-659 390,-653 390,-647 390,-647 390,-164 390,-164 390,-158 396,-152 402,-152"/>
<text text-anchor="middle" x="614" y="-643.8" font-family="Times,serif" font-size="14.00" fill="#000000">deep_recursion</text>
</g>
<!-- node1_1 -->
<g id="node1" class="node">
<title>node1_1</title>
<ellipse fill="#000000" stroke="#000000" cx="162" cy="-610" rx="31.6951" ry="18"/>
<text text-anchor="middle" x="162" y="-606.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Entry</text>
</g>
<!-- node1_3 -->
<g id="node3" class="node">
<title>node1_3</title>
<polygon fill="#f9f9f9" stroke="#000000" points="239.5,-556 84.5,-556 84.5,-520 239.5,-520 239.5,-556"/>
<text text-anchor="middle" x="162" y="-534.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Assign: x_emb = .*(...)</text>
</g>
<!-- node1_1&#45;&gt;node1_3 -->
<g id="edge1" class="edge">
<title>node1_1&#45;&gt;node1_3</title>
<path fill="none" stroke="#000000" d="M162,-591.8314C162,-584.131 162,-574.9743 162,-566.4166"/>
<polygon fill="#000000" stroke="#000000" points="165.5001,-566.4132 162,-556.4133 158.5001,-566.4133 165.5001,-566.4132"/>
</g>
<!-- node1_2 -->
<g id="node2" class="node">
<title>node1_2</title>
<ellipse fill="#ffb6c1" stroke="#000000" cx="267" cy="-34" rx="27" ry="18"/>
<text text-anchor="middle" x="267" y="-30.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Exit</text>
</g>
<!-- node1_4 -->
<g id="node4" class="node">
<title>node1_4</title>
<polygon fill="#f9f9f9" stroke="#000000" points="270.5,-484 53.5,-484 53.5,-448 270.5,-448 270.5,-484"/>
<text text-anchor="middle" x="162" y="-462.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Loop Start: _ = 1:m.cfg.L_cycles</text>
</g>
<!-- node1_3&#45;&gt;node1_4 -->
<g id="edge2" class="edge">
<title>node1_3&#45;&gt;node1_4</title>
<path fill="none" stroke="#000000" d="M162,-519.8314C162,-512.131 162,-502.9743 162,-494.4166"/>
<polygon fill="#000000" stroke="#000000" points="165.5001,-494.4132 162,-484.4133 158.5001,-494.4133 165.5001,-494.4132"/>
</g>
<!-- node1_5 -->
<g id="node5" class="node">
<title>node1_5</title>
<polygon fill="#f9f9f9" stroke="#000000" points="142.5,-412 59.5,-412 59.5,-376 142.5,-376 142.5,-412"/>
<text text-anchor="middle" x="101" y="-390.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Loop Body</text>
</g>
<!-- node1_4&#45;&gt;node1_5 -->
<g id="edge3" class="edge">
<title>node1_4&#45;&gt;node1_5</title>
<path fill="none" stroke="#000000" d="M146.6071,-447.8314C139.5096,-439.454 130.952,-429.3531 123.176,-420.1749"/>
<polygon fill="#000000" stroke="#000000" points="125.7348,-417.7807 116.6001,-412.4133 120.3939,-422.3056 125.7348,-417.7807"/>
</g>
<!-- node1_7 -->
<g id="node7" class="node">
<title>node1_7</title>
<polygon fill="#f9f9f9" stroke="#000000" points="295.5,-412 214.5,-412 214.5,-376 295.5,-376 295.5,-412"/>
<text text-anchor="middle" x="255" y="-390.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">After Loop</text>
</g>
<!-- node1_4&#45;&gt;node1_7 -->
<g id="edge6" class="edge">
<title>node1_4&#45;&gt;node1_7</title>
<path fill="none" stroke="#000000" d="M185.4678,-447.8314C197.0327,-438.8779 211.1404,-427.9558 223.6183,-418.2955"/>
<polygon fill="#000000" stroke="#000000" points="225.775,-421.0521 231.5397,-412.1628 221.4898,-415.5171 225.775,-421.0521"/>
</g>
<!-- node1_6 -->
<g id="node6" class="node">
<title>node1_6</title>
<polygon fill="#f9f9f9" stroke="#000000" points="186,-340 16,-340 16,-304 186,-304 186,-340"/>
<text text-anchor="middle" x="101" y="-318.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Assign: z = m.L_level(...)</text>
</g>
<!-- node1_5&#45;&gt;node1_6 -->
<g id="edge4" class="edge">
<title>node1_5&#45;&gt;node1_6</title>
<path fill="none" stroke="#000000" d="M101,-375.8314C101,-368.131 101,-358.9743 101,-350.4166"/>
<polygon fill="#000000" stroke="#000000" points="104.5001,-350.4132 101,-340.4133 97.5001,-350.4133 104.5001,-350.4132"/>
</g>
<!-- node1_6&#45;&gt;node1_4 -->
<g id="edge5" class="edge">
<title>node1_6&#45;&gt;node1_4</title>
<path fill="none" stroke="#000000" d="M123.9072,-340.1209C134.2697,-349.641 145.605,-362.1927 152,-376 160.9476,-395.3184 163.2271,-419.3831 163.3894,-437.7668"/>
<polygon fill="#000000" stroke="#000000" points="159.8887,-437.8163 163.2747,-447.8555 166.8883,-437.8959 159.8887,-437.8163"/>
</g>
<!-- node1_8 -->
<g id="node8" class="node">
<title>node1_8</title>
<polygon fill="#f9f9f9" stroke="#000000" points="374,-340 204,-340 204,-304 374,-304 374,-340"/>
<text text-anchor="middle" x="289" y="-318.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Assign: y = m.L_level(...)</text>
</g>
<!-- node1_7&#45;&gt;node1_8 -->
<g id="edge7" class="edge">
<title>node1_7&#45;&gt;node1_8</title>
<path fill="none" stroke="#000000" d="M263.5796,-375.8314C267.3358,-367.8771 271.8257,-358.369 275.9798,-349.5723"/>
<polygon fill="#000000" stroke="#000000" points="279.1996,-350.9503 280.3048,-340.4133 272.8699,-347.9612 279.1996,-350.9503"/>
</g>
<!-- node1_9 -->
<g id="node9" class="node">
<title>node1_9</title>
<polygon fill="#f9f9f9" stroke="#000000" points="371.5,-268 166.5,-268 166.5,-232 371.5,-232 371.5,-268"/>
<text text-anchor="middle" x="269" y="-246.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Assign: logits = m.lm_head(...)</text>
</g>
<!-- node1_8&#45;&gt;node1_9 -->
<g id="edge8" class="edge">
<title>node1_8&#45;&gt;node1_9</title>
<path fill="none" stroke="#000000" d="M283.9532,-303.8314C281.7906,-296.0463 279.2147,-286.7729 276.8152,-278.1347"/>
<polygon fill="#000000" stroke="#000000" points="280.1636,-277.1117 274.1148,-268.4133 273.419,-278.9852 280.1636,-277.1117"/>
</g>
<!-- node1_10 -->
<g id="node10" class="node">
<title>node1_10</title>
<polygon fill="#f9f9f9" stroke="#000000" points="374,-196 160,-196 160,-160 374,-160 374,-196"/>
<text text-anchor="middle" x="267" y="-174.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Assign: q_logits = m.q_head(...)</text>
</g>
<!-- node1_9&#45;&gt;node1_10 -->
<g id="edge9" class="edge">
<title>node1_9&#45;&gt;node1_10</title>
<path fill="none" stroke="#000000" d="M268.4953,-231.8314C268.2814,-224.131 268.0271,-214.9743 267.7894,-206.4166"/>
<polygon fill="#000000" stroke="#000000" points="271.2879,-206.3122 267.5115,-196.4133 264.2906,-206.5066 271.2879,-206.3122"/>
</g>
<!-- node1_11 -->
<g id="node11" class="node">
<title>node1_11</title>
<polygon fill="#f9f9f9" stroke="#000000" points="308.5,-124 225.5,-124 225.5,-88 308.5,-88 308.5,-124"/>
<text text-anchor="middle" x="267" y="-102.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Stmt: tuple</text>
</g>
<!-- node1_10&#45;&gt;node1_11 -->
<g id="edge10" class="edge">
<title>node1_10&#45;&gt;node1_11</title>
<path fill="none" stroke="#000000" d="M267,-159.8314C267,-152.131 267,-142.9743 267,-134.4166"/>
<polygon fill="#000000" stroke="#000000" points="270.5001,-134.4132 267,-124.4133 263.5001,-134.4133 270.5001,-134.4132"/>
</g>
<!-- node1_11&#45;&gt;node1_2 -->
<g id="edge11" class="edge">
<title>node1_11&#45;&gt;node1_2</title>
<path fill="none" stroke="#000000" d="M267,-87.8314C267,-80.131 267,-70.9743 267,-62.4166"/>
<polygon fill="#000000" stroke="#000000" points="270.5001,-62.4132 267,-52.4133 263.5001,-62.4133 270.5001,-62.4132"/>
</g>
<!-- node2_1 -->
<g id="node12" class="node">
<title>node2_1</title>
<ellipse fill="#000000" stroke="#000000" cx="508" cy="-610" rx="31.6951" ry="18"/>
<text text-anchor="middle" x="508" y="-606.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Entry</text>
</g>
<!-- node2_3 -->
<g id="node14" class="node">
<title>node2_3</title>
<polygon fill="#f9f9f9" stroke="#000000" points="545.5,-556 470.5,-556 470.5,-520 545.5,-520 545.5,-556"/>
<text text-anchor="middle" x="508" y="-534.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Assign: T</text>
</g>
<!-- node2_1&#45;&gt;node2_3 -->
<g id="edge12" class="edge">
<title>node2_1&#45;&gt;node2_3</title>
<path fill="none" stroke="#000000" d="M508,-591.8314C508,-584.131 508,-574.9743 508,-566.4166"/>
<polygon fill="#000000" stroke="#000000" points="511.5001,-566.4132 508,-556.4133 504.5001,-566.4133 511.5001,-566.4132"/>
</g>
<!-- node2_2 -->
<g id="node13" class="node">
<title>node2_2</title>
<ellipse fill="#ffb6c1" stroke="#000000" cx="672" cy="-178" rx="27" ry="18"/>
<text text-anchor="middle" x="672" y="-174.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Exit</text>
</g>
<!-- node2_4 -->
<g id="node15" class="node">
<title>node2_4</title>
<polygon fill="#f9f9f9" stroke="#000000" points="584.5,-484 431.5,-484 431.5,-448 584.5,-448 584.5,-484"/>
<text text-anchor="middle" x="508" y="-462.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Loop Start: _ = 1:T &#45; 1</text>
</g>
<!-- node2_3&#45;&gt;node2_4 -->
<g id="edge13" class="edge">
<title>node2_3&#45;&gt;node2_4</title>
<path fill="none" stroke="#000000" d="M508,-519.8314C508,-512.131 508,-502.9743 508,-494.4166"/>
<polygon fill="#000000" stroke="#000000" points="511.5001,-494.4132 508,-484.4133 504.5001,-494.4133 511.5001,-494.4132"/>
</g>
<!-- node2_5 -->
<g id="node16" class="node">
<title>node2_5</title>
<polygon fill="#f9f9f9" stroke="#000000" points="488.5,-412 405.5,-412 405.5,-376 488.5,-376 488.5,-412"/>
<text text-anchor="middle" x="447" y="-390.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Loop Body</text>
</g>
<!-- node2_4&#45;&gt;node2_5 -->
<g id="edge14" class="edge">
<title>node2_4&#45;&gt;node2_5</title>
<path fill="none" stroke="#000000" d="M492.6071,-447.8314C485.5096,-439.454 476.952,-429.3531 469.176,-420.1749"/>
<polygon fill="#000000" stroke="#000000" points="471.7348,-417.7807 462.6001,-412.4133 466.3939,-422.3056 471.7348,-417.7807"/>
</g>
<!-- node2_7 -->
<g id="node18" class="node">
<title>node2_7</title>
<polygon fill="#f9f9f9" stroke="#000000" points="660.5,-412 579.5,-412 579.5,-376 660.5,-376 660.5,-412"/>
<text text-anchor="middle" x="620" y="-390.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">After Loop</text>
</g>
<!-- node2_4&#45;&gt;node2_7 -->
<g id="edge17" class="edge">
<title>node2_4&#45;&gt;node2_7</title>
<path fill="none" stroke="#000000" d="M536.2623,-447.8314C550.4552,-438.7074 567.8282,-427.539 583.0636,-417.7449"/>
<polygon fill="#000000" stroke="#000000" points="585.2276,-420.5146 591.7467,-412.1628 581.4422,-414.6263 585.2276,-420.5146"/>
</g>
<!-- node2_6 -->
<g id="node17" class="node">
<title>node2_6</title>
<polygon fill="#f9f9f9" stroke="#000000" points="495.5,-340 398.5,-340 398.5,-304 495.5,-304 495.5,-340"/>
<text text-anchor="middle" x="447" y="-318.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Assign: (y, z)</text>
</g>
<!-- node2_5&#45;&gt;node2_6 -->
<g id="edge15" class="edge">
<title>node2_5&#45;&gt;node2_6</title>
<path fill="none" stroke="#000000" d="M447,-375.8314C447,-368.131 447,-358.9743 447,-350.4166"/>
<polygon fill="#000000" stroke="#000000" points="450.5001,-350.4132 447,-340.4133 443.5001,-350.4133 450.5001,-350.4132"/>
</g>
<!-- node2_6&#45;&gt;node2_4 -->
<g id="edge16" class="edge">
<title>node2_6&#45;&gt;node2_4</title>
<path fill="none" stroke="#000000" d="M469.9072,-340.1209C480.2697,-349.641 491.605,-362.1927 498,-376 506.9476,-395.3184 509.2271,-419.3831 509.3894,-437.7668"/>
<polygon fill="#000000" stroke="#000000" points="505.8887,-437.8163 509.2747,-447.8555 512.8883,-437.8959 505.8887,-437.8163"/>
</g>
<!-- node2_8 -->
<g id="node19" class="node">
<title>node2_8</title>
<polygon fill="#f9f9f9" stroke="#000000" points="830,-340 514,-340 514,-304 830,-304 830,-340"/>
<text text-anchor="middle" x="672" y="-318.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Assign: (y, z, logits, q_logits) = forward_inner(...)</text>
</g>
<!-- node2_7&#45;&gt;node2_8 -->
<g id="edge18" class="edge">
<title>node2_7&#45;&gt;node2_8</title>
<path fill="none" stroke="#000000" d="M633.1218,-375.8314C639.0499,-367.6232 646.1729,-357.7606 652.6933,-348.7323"/>
<polygon fill="#000000" stroke="#000000" points="655.684,-350.5693 658.7015,-340.4133 650.0092,-346.4708 655.684,-350.5693"/>
</g>
<!-- node2_9 -->
<g id="node20" class="node">
<title>node2_9</title>
<polygon fill="#f9f9f9" stroke="#000000" points="713.5,-268 630.5,-268 630.5,-232 713.5,-232 713.5,-268"/>
<text text-anchor="middle" x="672" y="-246.3" font-family="Helvetica,sans-Serif" font-size="14.00" fill="#000000">Stmt: tuple</text>
</g>
<!-- node2_8&#45;&gt;node2_9 -->
<g id="edge19" class="edge">
<title>node2_8&#45;&gt;node2_9</title>
<path fill="none" stroke="#000000" d="M672,-303.8314C672,-296.131 672,-286.9743 672,-278.4166"/>
<polygon fill="#000000" stroke="#000000" points="675.5001,-278.4132 672,-268.4133 668.5001,-278.4133 675.5001,-278.4132"/>
</g>
<!-- node2_9&#45;&gt;node2_2 -->
<g id="edge20" class="edge">
<title>node2_9&#45;&gt;node2_2</title>
<path fill="none" stroke="#000000" d="M672,-231.8314C672,-224.131 672,-214.9743 672,-206.4166"/>
<polygon fill="#000000" stroke="#000000" points="675.5001,-206.4132 672,-196.4133 668.5001,-206.4133 675.5001,-206.4132"/>
</g>
</g>
</svg>
